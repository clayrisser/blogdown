<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="restamp-page">
  <template>

    <template is="dom-if" if="[[display]]" restamp>
      <content></content>
    </template>

  </template>

  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'restamp-page',
        
        properties: {
          routeType: {
            type: String
          },
          currentRoutetype: {
            type: String
          },
          slug: {
            type: String
          },
          currentSlug: {
            type: String
          },
          pageType: {
            type: String
          },
          currentPagetype: {
            type: String
          },
          display: {
            type: Boolean,
            value: false
          }
        },

        ready: function() {

        },
        
        restamp: function() {
          this.display = false;
          if (this.routeType === this.currentRoutetype &&
            this.slug === this.currentSlug &&
            this.pageType === this.currentPagetype) {
            this._loadElement(this.slug);
          }
        },
        
        _debug: function() {
          app.debug('**************************');
          app.debug(this.routeType + ' === ' + this.currentRoutetype);
          app.debug(this.slug + ' === ' + this.currentSlug);
          app.debug(this.pageType + ' === ' + this.currentPagetype);
          app.debug('===========================');
        },
        
        _loadElement: function(name) {
          this.importHref('../elements/pages/page-' + name + '.html', function() {
            this.display = true;
            app.debug('page-' + name + '.html was imported.');
          }.bind(this), function() {
              window.history.back();
              app.debug('WARNING: page-' + name + '.html import failed to load');
              app.toast(this.failedToLoad);
          }.bind(this));
          app.firstPage = false; // Set here because this is one of the last actions of the initial page load
        }
      });
    })();
  </script>

</dom-module>