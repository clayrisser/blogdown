<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="load-authors">
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'load-authors',

        behaviors: [ ReduxBehavior ],

        actions: {
          loadAuthors: () => {
            return function(dispatch) {
              return fetch('../../../content/authors.json')
                .then((res) => {
                  return res.json();
                }).then((body) => {
                  dispatch({
                    type: LOAD_AUTHORS,
                    authors: body
                  });
                  app.log.info('authors =>');
                  app.log.info(store.getState().authors);
                  this.resolve(body);
                  return body;
                }).catch((err) => {
                  this.reject(err);
                  throw err;
                });
            };
          }
        },

        load: function() {
          app.log.debug('loading authors . . .');
          return new Promise((resolve, reject) => {
            this.resolve = resolve;
            this.reject = reject;
            this.dispatch('loadAuthors');
          });
        }
      });
    })();
  </script>
</dom-module>
