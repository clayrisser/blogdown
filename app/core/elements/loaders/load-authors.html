<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="load-authors">
  <template>

    <iron-ajax id="getAuthors"
      url="../../../content/authors.json"
      handle-as="json"
      on-response="authorsResponse"
      on-error="authorsError"
      last-response="{{authors}}"i
      last-error="{{authorsErrorResponse}}">
    </iron-ajax>

  </template>
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'load-authors',

        load: function() {
          return new Promise(function(resolve, reject) {
            this.resolveRequest = resolve;
            this.rejectRequest = reject;
            this.$.getAuthors.generateRequest();
          }.bind(this));
        },

        authorsResponse: function() {
          this.storeAuthors(this.authors);
          this.resolveRequest(app.authors);
        },

        authorsError: function() {
          this.rejectRequest(this.authorsErrorResponse);
        },

        storeAuthors: function(authors) {
          app.authors = authors;
        }
      });
    })();
  </script>
</dom-module>
