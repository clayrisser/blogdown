<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="load-settings">
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'load-settings',

        load: function() {
          console.log('loading settings . . .');
          return fetch('../../../content/settings.json')
            .then((res) => {
              return res.json();
            }).then((body) => {
              var settings = {};
              _.each(body, (setting, key) => {
                if (key === 'logLevel') return settings[key] = {
                  name: setting,
                  value: this._getLogLevel(setting)
                };
                return settings[key] = setting;
              });
              app.set('settings', settings);
              console.log('app.settings =>');
              console.log(app.settings);
              return settings;
            });
        },

        _getLogLevel: function(debug) {
          if (typeof debug === 'number') return debug;
          switch(debug) {
            case 'silent':
              return 0;
            case 'error':
              return 1;
            case 'warn':
              return 2;
            case 'info':
              return 3;
            case 'debug':
              return 4;
            case 'silly':
              return 5;
            default:
              return 3;
          }
        }
      });
    })();
  </script>
</dom-module>
