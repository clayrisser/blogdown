<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="load-pages">
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'load-pages',

        load: function() {
          app.log.debug('loading pages . . .');
          return fetch('../../../content/pages.json')
            .then((res) => {
              return res.json();
            }).then((pages) => {
              app.set('pages', this._getPagesMeta(pages));
              app.log.info('app.pages =>');
              app.log.info(app.pages);
              return pages;
            });
        },

        _getPagesMeta: function(pages) {
          var pagesMeta = [];
          _.each(pages, function(page) {
            pagesMeta.push({
              title: page.title ? page.title : changeCase.titleCase(page.slug),
              slug: page.slug ? page.slug : changeCase.paramCase(page.title),
              addToMenu: page.addToMenu ? page.addToMenu : true,
              format: page.format ? page.format : 'md'
            });
          });
          return pagesMeta;
        }
      });
    })();
  </script>
</dom-module>
