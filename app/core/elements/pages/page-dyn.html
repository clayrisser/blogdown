<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="page-dyn">
  <template></template>
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'page-dyn',

        behaviors: [
          ReduxBehavior,
          ReduxActions
        ],

        properties: {
          page: {
            type: Object,
            value: {}
          },
          body: {
            type: String,
            value: ''
          },
          format: {
            type: String,
            value: 'dyn.html'
          }
        },

        ready: function() {
          Polymer.dom(this.root).innerHTML = '<dyn-' + this.page.slug + '>';
          this._loadElement(this.page.slug, this.format).then(() => {
            this.dispatch('appLoading', false);
          });;
        },

        _loadElement: function(name, format) {
          return new Promise((resolve, reject) => {
            this.importHref('../content/pages/' + name + '.' + format, () => {
              app.log.info(name + '.' + format + ' was imported.');
              resolve();
            }, (err) => {
              app.log.error(name + '.' + format + ' import failed to load');
              resolve();
            });
          });
        }
      });
    })();
  </script>
</dom-module>
