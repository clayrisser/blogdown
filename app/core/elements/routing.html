<script src="../bower_components/page/page.js"></script>

<script>
  window.addEventListener('WebComponentsReady', () => {
    if (window.location.port === '') {
      page.base(app.baseUrl.replace(/\/$/, ''));
    }

    function middleware(ctx, next) {
      next();
    }

    page('*', middleware, (ctx, next) => {
      next();
    });

    page('/', (req) => {
      app.route = {
        type: 'home',
        slugs: req.params
      };
    });

    page(app.baseUrl, (req) => {
      app.route = {
        type: 'home',
        slugs: req.params
      };
    });

    page('/:parent', (req) => {
      app.route = {
        type: 'parent',
        slugs: req.params
      };
    });

    page('/:parent/:child', (req) => {
      app.route = {
        type: 'child',
        slugs: req.params
      };
    });

    page('*', (req) => {
      app.route = {
        type: '404',
        slugs: req.params
      };
    });

    page({
      hashbang: true
    });
  });
</script>
